// app/lib/notificationRouter.js

/**
 * Maps push notification payloads (from Expo / Edge Function)
 * to the correct in-app route using Expo Router.
 *
 * Adjusted for your folder structure:
 * app/(app)/settings/help/[ticketid].js
 */
export function routeForNotificationData(data) {
  if (!data || !data.type) return { path: "/notifications" };

  const type = String(data.type);

  // ðŸ“¨ Support message â†’ opens the user's ticket thread
  if (type === "support_message") {
    const tid = String(data.ticket_id || "").trim();
    if (!tid) return { path: "/notifications" };

    // Navigate to: /settings/help/<ticketid>
    return { path: `/settings/help/${encodeURIComponent(tid)}` };
  }

  // ðŸ§¾ Quote created â†’ open the quote preview
  if (type === "quote_created") {
    const qid = String(data.quote_id || "").trim();
    if (!qid) return { path: "/notifications" };

    return { path: `/quotes/preview?id=${encodeURIComponent(qid)}` };
  }

  // Default â†’ notifications list
  return { path: "/notifications" };
}

export default routeForNotificationData;